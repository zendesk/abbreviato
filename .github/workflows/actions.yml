name: Continuous Integration
on: [push]
jobs:
  specs:
    name: specs
    runs-on: ubuntu-latest
    env:
      RAILS_ENV: test
    strategy:
      fail-fast: false
      matrix:
        ruby:
          - '2.7'
#          - '3.0'
#          - '3.1'
#          - '3.2'
        task:
          - spec
    steps:
    - uses: zendesk/checkout@v3
    - uses: zendesk/setup-ruby@v1
      with:
        ruby-version: ${{ matrix.ruby }}

    - name: Gem install
      run: |
        set -eu -o pipefail
        bundle install

    - name: Run ${{ matrix.task }} on Ruby ${{ matrix.ruby }}
      run: bundle exec rake ${{ matrix.task }}
#  linters:
#    name: linters
#    runs-on: ubuntu-latest
#    strategy:
#      fail-fast: false
#      matrix:
#        ruby:
#          - 2.7
#        task:
#          - brakeman
#          - flay
#          - rubocop
#    steps:
#    - uses: zendesk/checkout@v3
#    - uses: zendesk/setup-ruby@v1
#      with:
#        ruby-version: ${{ matrix.ruby }}
#
#    - name: Gem install
#      run: |
#        set -eu -o pipefail
#        bundle install
#        bundle update brakeman flay rubocop
#
#    - name: Run ${{ matrix.task }} on Ruby ${{ matrix.ruby }}
#      run: bundle exec rake ${{ matrix.task }}
